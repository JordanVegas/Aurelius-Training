מטריצה ב-C היא **מערך דו־ממדי**: למעשה “מערך של מערכים”. בזיכרון זה יכול להיות או **בלוק רציף אחד** או **אוסף שורות נפרדות**—תלוי איך מממשים.

---

## מימוש סטטי (בזמן קומפילציה)

### 1) מערך דו־ממדי רגיל על ה-stack/סטטי

```c
int mat[3][4];                    // 3 שורות, 4 עמודות
int mat2[2][3] = {{1,2,3},{4,5,6}};
```

* הזיכרון **רציף**: 3*4 איברים אחד אחרי השני.
* גודל קבוע בזמן קומפילציה.

גישה:

```c
mat[i][j] = 7;
```

### 2) סטטי גלובלי/סטטי קובץ

```c
static int mat[100][100];
```

חי לכל אורך התוכנית, ומאותחל ל־0 כברירת מחדל.

---

## מימוש דינמי (בזמן ריצה)

יש שתי שיטות נפוצות:

---

### שיטה A: בלוק רציף אחד (מומלץ לרוב) ✅

מקצים `rows*cols` איברים בבת אחת, וזה נשאר רציף בזיכרון (מהיר ונוח לקאש).

**אופציה 1: גישה עם חישוב אינדקס**

```c
#include <stdlib.h>

int *mat = malloc(rows * cols * sizeof(int));
if (!mat) return; // טיפול כשל

// גישה: mat[i*cols + j]
mat[i*cols + j] = 5;

// שחרור
free(mat);
```

**אופציה 2: שימוש ב־VLA pointer כדי לכתוב mat[i][j]**

```c
#include <stdlib.h>

int (*mat)[cols] = malloc(rows * sizeof *mat);
if (!mat) return;

// גישה טבעית:
mat[i][j] = 5;

free(mat);
```

> זה עדיין בלוק רציף אחד, רק “עוטפים” אותו כך ש־`mat[i][j]` יעבוד.

---

### שיטה B: מערך של מצביעים (כל שורה מוקצית בנפרד) ⚠️

מקצים קודם מערך של מצביעים לשורות, ואז לכל שורה מקצים עמודות.

```c
#include <stdlib.h>

int **mat = malloc(rows * sizeof(int*));
if (!mat) return;

for (int i = 0; i < rows; i++) {
    mat[i] = malloc(cols * sizeof(int));
    if (!mat[i]) {
        // ניקוי חלקי במקרה כשל
        for (int k = 0; k < i; k++) free(mat[k]);
        free(mat);
        return;
    }
}

// גישה:
mat[i][j] = 5;

// שחרור:
for (int i = 0; i < rows; i++) free(mat[i]);
free(mat);
```

מאפיינים:

* השורות **לא בהכרח רציפות בזיכרון**.
* קל ליצור “מטריצה משוננת” (כל שורה באורך שונה).
* יותר הקצאות → יותר overhead ופחות cache-friendly.

---

## סיכום מהיר

| שיטה                            | רציף בזיכרון? | גישה `mat[i][j]`     | הקצאות   | מתי לבחור                  |
| ------------------------------- | ------------- | -------------------- | -------- | -------------------------- |
| סטטי `int a[R][C]`              | כן            | כן                   | 0        | גדלים קבועים               |
| דינמי בלוק אחד `int*`           | כן            | לא (צריך `i*cols+j`) | 1        | הכי יעיל לרוב              |
| דינמי בלוק אחד עם `int (*a)[C]` | כן            | כן                   | 1        | כשכן רוצים `a[i][j]`       |
| דינמי `int**` שורות נפרדות      | לא בהכרח      | כן                   | `1+rows` | כשצריך שורות באורכים שונים |

---

אם תרצה, אכתוב לך גם **דוגמה מלאה** שמקצה מטריצה דינמית, מאתחלת אותה, מדפיסה אותה ומשחררת נכון (כולל טיפול בכשל הקצאה).
